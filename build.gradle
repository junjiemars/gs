apply plugin: 'java'

sourceCompatibility = 1.5
version = '1.0'

repositories {

    maven {
//        url 'http://repo2.maven.org/maven2'
        url 'http://mirrors.ibiblio.org/pub/mirrors/maven2'
    }

//    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.11'
    compile 'com.google.code.gson:gson:2.3'
}

jar {
    manifest {
        attributes('Build-By': "$System.env.USER@" + hostname(),
                   'Build-version': jar_version())
    }
}

String hostname() {
    InetAddress.getLocalHost().getHostName()
}

String vcs_version() {
    def git = 'git describe --tags --always HEAD'.execute()
    git.waitFor()
    git.in.text
}

String jar_version() {
    String.format('%s-%s', version, vcs_version())
}